          _q4_start_           
-------------------------------
 2012-12-07 15:38:03.909064-05
(1 row)

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           QUERY PLAN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=985648.95..985648.95 rows=1 width=132)
   Output: ((di.account_sid)::character varying), di.account_name, ((di.district_sid)::character varying), di.district_name, (NULL::unknown), (NULL::unknown), (NULL::unknown), (NULL::unknown), (NULL::unknown), (NULL::text), (NULL::unknown), (NULL::unknown), (NULL::unknown), (NULL::unknown), (NULL::unknown), (NULL::unknown), (NULL::unknown), (NULL::unknown), (NULL::unknown), (NULL::unknown), (NULL::unknown), (NULL::unknown), (NULL::unknown), (NULL::unknown), fao.academic_year_code, fao.academic_year_name, fao.academic_year_order, ((((fao.period_code)::text || '_'::text) || (fao.academic_year_code)::text)), fao.period_abbrev, fao.period_order, dpl.general_level_code, dpl.measure_specific_level_name, dpl.level_order, (avg(fao.score)), (count(1)), fao.period_code, fao.academic_year_abbrev, fao.period_name, fao.period_order
   Sort Key: ((di.account_sid)::character varying), di.account_name, di.district_name, fao.academic_year_order, fao.period_order, dpl.level_order
   ->  HashAggregate  (cost=985648.91..985648.94 rows=1 width=132)
         Output: ((di.account_sid)::character varying), di.account_name, ((di.district_sid)::character varying), di.district_name, NULL::unknown, NULL::unknown, NULL::unknown, NULL::unknown, NULL::unknown, NULL::text, NULL::unknown, NULL::unknown, NULL::unknown, NULL::unknown, NULL::unknown, NULL::unknown, NULL::unknown, NULL::unknown, NULL::unknown, NULL::unknown, NULL::unknown, NULL::unknown, NULL::unknown, NULL::unknown, fao.academic_year_code, fao.academic_year_name, fao.academic_year_order, (((fao.period_code)::text || '_'::text) || (fao.academic_year_code)::text), fao.period_abbrev, fao.period_order, dpl.general_level_code, dpl.measure_specific_level_name, dpl.level_order, avg(fao.score), count(1), fao.period_code, fao.academic_year_abbrev, fao.period_name, fao.period_order
         ->  Nested Loop  (cost=983163.98..985648.87 rows=1 width=132)
               Output: (di.account_sid)::character varying, di.account_name, (di.district_sid)::character varying, di.district_name, fao.academic_year_code, fao.academic_year_name, fao.academic_year_order, fao.period_abbrev, dpl.general_level_code, dpl.measure_specific_level_name, dpl.level_order, fao.period_code, fao.academic_year_abbrev, fao.period_name, fao.period_order, fao.score
               Join Filter: (fe.dim_grade_key = dg.dim_grade_key)
               ->  Nested Loop  (cost=983163.98..985647.52 rows=1 width=136)
                     Output: fao.academic_year_code, fao.academic_year_name, fao.academic_year_order, fao.period_abbrev, fao.period_code, fao.academic_year_abbrev, fao.period_name, fao.period_order, fao.score, fe.dim_grade_key, di.account_sid, di.account_name, di.district_sid, di.district_name, dpl.general_level_code, dpl.measure_specific_level_name, dpl.level_order
                     ->  Nested Loop  (cost=983163.98..985639.24 rows=1 width=118)
                           Output: fao.academic_year_code, fao.academic_year_name, fao.academic_year_order, fao.period_abbrev, fao.period_code, fao.academic_year_abbrev, fao.period_name, fao.period_order, fao.score, fao.dim_perf_level_key, fe.dim_grade_key, di.account_sid, di.account_name, di.district_sid, di.district_name
                           ->  Nested Loop  (cost=983163.98..984320.90 rows=156 width=77)
                                 Output: fao.academic_year_code, fao.academic_year_name, fao.academic_year_order, fao.period_abbrev, fao.period_code, fao.academic_year_abbrev, fao.period_name, fao.period_order, fao.score, fao.dim_perf_level_key, fe.dim_institution_key, fe.dim_grade_key
                                 Join Filter: (fao.dim_student_key = fe.dim_student_key)
                                 ->  Nested Loop  (cost=983163.98..983215.73 rows=1 width=77)
                                       Output: fao.academic_year_code, fao.academic_year_name, fao.academic_year_order, fao.period_abbrev, fao.period_code, fao.academic_year_abbrev, fao.period_name, fao.period_order, fao.score, fao.dim_student_key, fao.dim_perf_level_key, dstu.dim_student_key
                                       ->  Subquery Scan on fao  (cost=983163.98..983164.18 rows=1 width=73)
                                             Output: fao.dim_student_key, fao.eternal_student_sid, fao.academic_year_code, fao.academic_year_name, fao.academic_year_abbrev, fao.academic_year_order, fao.period_code, fao.period_name, fao.period_abbrev, fao.period_order, fao.dim_perf_level_key, fao.performance_level_flag, fao.score, fao.assessed_in_all_periods_count
                                             Filter: fao.performance_level_flag
                                             ->  WindowAgg  (cost=983163.98..983164.12 rows=6 width=66)
                                                   Output: fao.dim_student_key, fao.eternal_student_sid, dp.academic_year_code, dp.academic_year_name, dp.academic_year_abbrev, (dp.academic_year_code)::integer, dp.period_code, dp.period_name, dp.period_abbrev, dp.period_order, fao.dim_perf_level_key, daot.performance_level_flag, NULL::bigint, count(1) OVER (?)
                                                   ->  Sort  (cost=983163.98..983164.00 rows=6 width=66)
                                                         Output: fao.eternal_student_sid, fao.dim_student_key, dp.academic_year_code, dp.academic_year_name, dp.academic_year_abbrev, dp.period_code, dp.period_name, dp.period_abbrev, dp.period_order, fao.dim_perf_level_key, daot.performance_level_flag
                                                         Sort Key: fao.eternal_student_sid
                                                         ->  Nested Loop  (cost=6163.46..983163.91 rows=6 width=66)
                                                               Output: fao.eternal_student_sid, fao.dim_student_key, dp.academic_year_code, dp.academic_year_name, dp.academic_year_abbrev, dp.period_code, dp.period_name, dp.period_abbrev, dp.period_order, fao.dim_perf_level_key, daot.performance_level_flag
                                                               Join Filter: (fao.dim_assmt_period_key = dp.dim_period_key)
                                                               ->  Nested Loop  (cost=6163.46..983058.15 rows=549 width=17)
                                                                     Output: fao.dim_student_key, fao.eternal_student_sid, fao.dim_perf_level_key, fao.dim_assmt_period_key, daot.performance_level_flag
                                                                     ->  Index Scan using dim_assmt_outcome_type_nkey on edware.dim_assmt_outcome_type daot  (cost=0.00..95.63 rows=1 width=5)
                                                                           Output: daot.dim_assmt_outcome_type_key, daot.assmt_code, daot.assmt_name, daot.assmt_abbrev, daot.assmt_version_code, daot.assmt_version_name, daot.assmt_version_abbrev, daot.assmt_version_rank, daot.daot_measure_type_code, daot.daot_measure_type_name, daot.daot_measure_type_rank, daot.daot_hier_level, daot.daot_hier_level_code, daot.daot_hier_level_name, daot.daot_hier_level_rank, daot.daot_hier_level_1_code, daot.daot_hier_level_1_name, daot.daot_hier_level_1_abbrev, daot.daot_hier_level_2_code, daot.daot_hier_level_2_name, daot.daot_hier_level_2_abbrev, daot.daot_hier_level_3_code, daot.daot_hier_level_3_name, daot.daot_hier_level_3_abbrev, daot.daot_hier_level_4_code, daot.daot_hier_level_4_name, daot.daot_hier_level_4_abbrev, daot.daot_hier_level_5_code, daot.daot_hier_level_5_name, daot.daot_hier_level_5_abbrev, daot.performance_level_flag, daot.performance_level_type_code, daot.outcome_int_flag, daot.outcome_int_code, daot.outcome_int_name, daot.outcome_int_abbrev, daot.outcome_float_flag, daot.outcome_float_code, daot.outcome_float_name, daot.outcome_float_abbrev, daot.outcome_string_flag, daot.outcome_string_code, daot.outcome_string_name, daot.outcome_string_abbrev, daot.outcome_rank, daot.create_date, daot.mod_date, daot.part_key, daot.pg_by_grade_flag, daot.assmt_course_code, daot.assmt_course_name
                                                                           Index Cond: (((daot.assmt_code)::text = '7'::text) AND ((daot.daot_measure_type_code)::text = 'BM_AM'::text))
                                                                           Filter: (((daot.daot_hier_level_code)::text = '2'::text) AND CASE WHEN ((daot.assmt_code)::text = '706'::text) THEN true WHEN ((daot.assmt_code)::text = '706s'::text) THEN true ELSE ((daot.assmt_version_code)::text = ANY ('{1,1,1,1,1}'::text[])) END AND ((CASE daot.daot_hier_level WHEN 1 THEN daot.daot_hier_level_1_code WHEN 2 THEN daot.daot_hier_level_2_code WHEN 3 THEN daot.daot_hier_level_3_code WHEN 4 THEN daot.daot_hier_level_4_code WHEN 5 THEN daot.daot_hier_level_5_code ELSE NULL::character varying END)::text = 'INSTREC'::text))
                                                                     ->  Bitmap Heap Scan on edware.fact_assmt_outcome fao  (cost=6163.46..982255.34 rows=70718 width=20)
                                                                           Output: fao.fact_assmt_outcome_key, fao.part_key, fao.active_flag, fao.dim_student_key, fao.eternal_student_sid, fao.year_sid, fao.dim_assmt_staff_key, fao.dim_assmt_outcome_type_key, fao.dim_assmt_period_key, fao.dim_assmt_grade_key, fao.dim_assmt_time_key, fao.dim_assmt_sync_time_key, fao.dim_perf_level_key, fao.dim_custom_perf_level_key, fao.dim_assmt_institution_key, fao.dim_curr_institution_key, fao.dim_eoy_institution_key, fao.dim_curr_enroll_attr_key, fao.dim_eoy_enroll_attr_key, fao.dim_eoy_student_grade_key, fao.dim_curr_student_grade_key, fao.dim_eoy_section_group_key, fao.dim_curr_section_group_key, fao.dim_offic_section_key, fao.dim_curr_offic_section_key, fao.outcome_int, fao.outcome_string, fao.outcome_float, fao.assmt_date, fao.sync_date, fao.assmt_instance_sid, fao.assmt_instance_rank, fao.create_date, fao.mod_date, fao.assmt_custom_id_code, fao.assmt_custom_id_name
                                                                           Recheck Cond: (fao.dim_assmt_outcome_type_key = daot.dim_assmt_outcome_type_key)
                                                                           Filter: ((fao.assmt_instance_rank = 1) AND (fao.year_sid = 9))
                                                                           ->  Bitmap Index Scan on idx_fao_dim_assmt_outcome_type_key  (cost=0.00..6145.78 rows=319372 width=0)
                                                                                 Index Cond: (fao.dim_assmt_outcome_type_key = daot.dim_assmt_outcome_type_key)
                                                               ->  Materialize  (cost=0.00..39.90 rows=8 width=57)
                                                                     Output: dp.academic_year_code, dp.academic_year_name, dp.academic_year_abbrev, dp.period_code, dp.period_name, dp.period_abbrev, dp.period_order, dp.dim_period_key
                                                                     ->  Seq Scan on edware.dim_period dp  (cost=0.00..39.86 rows=8 width=57)
                                                                           Output: dp.academic_year_code, dp.academic_year_name, dp.academic_year_abbrev, dp.period_code, dp.period_name, dp.period_abbrev, dp.period_order, dp.dim_period_key
                                                                           Filter: ((((dp.period_code)::text || '_'::text) || (dp.academic_year_code)::text) = ANY ('{32_9,31_9}'::text[]))
                                       ->  Index Scan using dim_student_pkey on edware.dim_student dstu  (cost=0.00..51.55 rows=1 width=4)
                                             Output: dstu.dim_student_key, dstu.student_sid, dstu.eternal_student_sid, dstu.first_name, dstu.middle_name, dstu.last_name, dstu.suffix, dstu.dob, dstu.email, dstu.home_phone, dstu.place_of_birth_code, dstu.place_of_birth_name, dstu.gender_code, dstu.gender_name, dstu.grad_cohort_year_code, dstu.grad_cohort_year_name, dstu.age_as_of_curr_year, dstu.status_code, dstu.demo_flag, dstu.custom_id_1_code, dstu.custom_id_1_type_code, dstu.custom_id_2_code, dstu.custom_id_2_type_code, dstu.custom_id_3_code, dstu.custom_id_3_type_code, dstu.custom_id_4_code, dstu.custom_id_4_type_code, dstu.custom_id_5_code, dstu.custom_id_5_type_code, dstu.source_create_date, dstu.source_mod_date, dstu.create_date, dstu.mod_date, dstu.part_key, dstu.inst_sid, dstu.year_sid
                                             Index Cond: (dstu.dim_student_key = fao.dim_student_key)
                                             Filter: (NOT dstu.demo_flag)
                                 ->  Index Scan using idx_fe_dim_student_key on edware.fact_enroll fe  (cost=0.00..1103.12 rows=163 width=12)
                                       Output: fe.fact_enroll_key, fe.part_key, fe.dim_institution_key, fe.dim_student_key, fe.dim_grade_key, fe.dim_section_key, fe.dim_term_key, fe.dim_teacher_staff_key, fe.dim_enroll_attr_key, fe.dim_inst_admit_time_key, fe.dim_inst_disc_time_key, fe.dim_sect_admit_time_key, fe.dim_sect_disc_time_key, fe.enrolled_in_inst_flag, fe.enrolled_in_sect_flag, fe.student_sid, fe.eternal_student_sid, fe.section_sid, fe.year_sid, fe.is_reporting_classe, fe.section_type_code, fe.section_subtype_code, fe.create_date, fe.mod_date
                                       Index Cond: (fe.dim_student_key = dstu.dim_student_key)
                                       Filter: fe.is_reporting_classe
                           ->  Index Scan using dim_institution_pkey on edware.dim_institution di  (cost=0.00..8.44 rows=1 width=49)
                                 Output: di.dim_institution_key, di.academic_year_code, di.academic_year_name, di.current_acad_year_flag, di.grade_config_code, di.grade_config_name, di.school_year_sid, di.school_sid, di.school_name, di.school_phone, di.school_address_1, di.school_address_2, di.school_city, di.school_zip_code, di.district_sid, di.district_name, di.municipality_sid, di.municipality_name, di.account_sid, di.account_name, di.state_sid, di.state_code, di.state_name, di.country_sid, di.country_name, di.location_1_code, di.location_1_name, di.location_2_code, di.location_2_name, di.location_3_code, di.location_3_name, di.location_4_code, di.location_4_name, di.location_5_code, di.location_5_name, di.location_1_type_code, di.location_1_type_name, di.location_2_type_code, di.location_2_type_name, di.location_3_type_code, di.location_3_type_name, di.location_4_type_code, di.location_4_type_name, di.location_5_type_code, di.location_5_type_name, di.school_open_date, di.school_years_open, di.title_1_flag, di.reading_first_flag, di.url, di.custom_id_1_code, di.custom_id_1_type_code, di.custom_id_2_code, di.custom_id_2_type_code, di.custom_id_3_code, di.custom_id_3_type_code, di.custom_id_4_code, di.custom_id_4_type_code, di.custom_id_5_code, di.custom_id_5_type_code, di.dim_curr_institution_key, di.status_code, di.demo_flag, di.create_date, di.mod_date, di.part_key
                                 Index Cond: (di.dim_institution_key = fe.dim_institution_key)
                                 Filter: ((NOT di.demo_flag) AND (di.account_sid = 15753406) AND (di.district_sid = 15753404))
                     ->  Index Scan using dim_perf_level_pkey on edware.dim_perf_level dpl  (cost=0.00..8.27 rows=1 width=26)
                           Output: dpl.dim_perf_level_key, dpl.level_order, dpl.level_type_code, dpl.level_type_name, dpl.general_level_code, dpl.general_level_name, dpl.measure_type_specific_level_code, dpl.measure_type_specific_level_name, dpl.measure_specific_level_code, dpl.measure_specific_level_name, dpl.level_code, dpl.level_name, dpl.level_order_name, dpl.create_date, dpl.mod_date, dpl.part_key, dpl.account_sid
                           Index Cond: (dpl.dim_perf_level_key = fao.dim_perf_level_key)
               ->  Seq Scan on edware.dim_grade dg  (cost=0.00..1.15 rows=15 width=4)
                     Output: dg.dim_grade_key, dg.grade_level_sid, dg.grade_level_name, dg.grade_band_code, dg.grade_band_name, dg.grade_level_order, dg.updated_flag, dg.grade_band_flag, dg.grade_band_min, dg.grade_band_max, dg.create_date, dg.mod_date, dg.part_key
(62 rows)

          _q4_finish_          
-------------------------------
 2012-12-07 15:38:03.943141-05
(1 row)

